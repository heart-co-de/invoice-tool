import{y as D,z as ne,A as ee,B as k,D as Pe,G as h,d as A,H as K,I as V,J as ke,K as De,L as oe,M as ie,N as re,O as Ne,P as Te,Q as Le,R as Y,T as me,F as j,S as te,V as ae,W as Ee,X as Be,Y as Ue,Z as $e,$ as Fe,a0 as G,a1 as U,a2 as Ae,h as qe,v as F,j as B,b as u,a3 as z,o as I,g as N,l as M,f as C,a4 as fe,c as T,i as ue,a5 as J,t as $,a6 as be,e as W,a7 as Me,_ as X,a8 as je,a9 as He,aa as Qe,ab as de,w as se,ac as Ke,n as xe,ad as ze,r as We,p as Ge,s as Je,ae as Xe,af as Ye,ag as Ze}from"./index-c0461d2d.js";import{a as et,b as tt,c as ot}from"./useInvoice-3f4416c8.js";import{_ as le}from"./BaseButton.vue_vue_type_script_setup_true_lang-099feaf5.js";import{o as pe}from"./onceTruthy-7f0e7a92.js";import"./index-834d5479.js";function at(e){throw new Error("Unexpected object: "+e)}var E=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(E||{});function lt(e,l){let a=l.resolveItems();if(a.length<=0)return null;let d=l.resolveActiveIndex(),o=d??-1,t=(()=>{switch(e.focus){case 0:return a.findIndex(n=>!l.resolveDisabled(n));case 1:{let n=a.slice().reverse().findIndex((s,i,c)=>o!==-1&&c.length-i-1>=o?!1:!l.resolveDisabled(s));return n===-1?n:a.length-1-n}case 2:return a.findIndex((n,s)=>s<=o?!1:!l.resolveDisabled(n));case 3:{let n=a.slice().reverse().findIndex(s=>!l.resolveDisabled(s));return n===-1?n:a.length-1-n}case 4:return a.findIndex(n=>l.resolveId(n)===e.id);case 5:return null;default:at(e)}})();return t===-1?d:t}function ce(e,l){if(e)return e;let a=l??"button";if(typeof a=="string"&&a.toLowerCase()==="button")return"button"}function nt(e,l){let a=D(ce(e.value.type,e.value.as));return ne(()=>{a.value=ce(e.value.type,e.value.as)}),ee(()=>{var d;a.value||k(l)&&k(l)instanceof HTMLButtonElement&&!((d=k(l))!=null&&d.hasAttribute("type"))&&(a.value="button")}),a}function it({container:e,accept:l,walk:a,enabled:d}){ee(()=>{let o=e.value;if(!o||d!==void 0&&!d.value)return;let t=Pe(e);if(!t)return;let n=Object.assign(i=>l(i),{acceptNode:l}),s=t.createTreeWalker(o,NodeFilter.SHOW_ELEMENT,n,!1);for(;s.nextNode();)a(s.currentNode)})}function ye(e={},l=null,a=[]){for(let[d,o]of Object.entries(e))he(a,ge(l,d),o);return a}function ge(e,l){return e?e+"["+l+"]":l}function he(e,l,a){if(Array.isArray(a))for(let[d,o]of a.entries())he(e,ge(l,d.toString()),o);else a instanceof Date?e.push([l,a.toISOString()]):typeof a=="boolean"?e.push([l,a?"1":"0"]):typeof a=="string"?e.push([l,a]):typeof a=="number"?e.push([l,`${a}`]):a==null?e.push([l,""]):ye(a,l,e)}function ut(e,l,a){let d=D(a==null?void 0:a.value),o=h(()=>e.value!==void 0);return[h(()=>o.value?e.value:d.value),function(t){return o.value||(d.value=t),l==null?void 0:l(t)}]}function ve(e){return[e.screenX,e.screenY]}function st(){let e=D([-1,-1]);return{wasMoved(l){let a=ve(l);return e.value[0]===a[0]&&e.value[1]===a[1]?!1:(e.value=a,!0)},update(l){e.value=ve(l)}}}function rt(e,l){return e===l}var dt=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(dt||{}),pt=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(pt||{}),ct=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(ct||{});let _e=Symbol("ComboboxContext");function Z(e){let l=Ue(_e,null);if(l===null){let a=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(a,Z),a}return l}let we=A({name:"Combobox",emits:{"update:modelValue":e=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],default:()=>rt},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},name:{type:String},nullable:{type:Boolean,default:!1},multiple:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(e,{slots:l,attrs:a,emit:d}){let o=D(1),t=D(null),n=D(null),s=D(null),i=D(null),c=D({static:!1,hold:!1}),f=D([]),x=D(null),O=D(1),S=D(!1);function P(m=g=>g){let g=x.value!==null?f.value[x.value]:null,R=$e(m(f.value.slice()),v=>k(v.dataRef.domRef)),r=g?R.indexOf(g):null;return r===-1&&(r=null),{options:R,activeOptionIndex:r}}let p=h(()=>e.multiple?1:0),b=h(()=>e.nullable),[_,L]=ut(h(()=>e.modelValue===void 0?K(p.value,{[1]:[],[0]:void 0}):e.modelValue),m=>d("update:modelValue",m),h(()=>e.defaultValue)),y={comboboxState:o,value:_,mode:p,compare(m,g){if(typeof e.by=="string"){let R=e.by;return(m==null?void 0:m[R])===(g==null?void 0:g[R])}return e.by(m,g)},defaultValue:h(()=>e.defaultValue),nullable:b,inputRef:n,labelRef:t,buttonRef:s,optionsRef:i,disabled:h(()=>e.disabled),options:f,change(m){L(m)},activeOptionIndex:h(()=>{if(S.value&&x.value===null&&f.value.length>0){let m=f.value.findIndex(g=>!g.dataRef.disabled);if(m!==-1)return m}return x.value}),activationTrigger:O,optionsPropsRef:c,closeCombobox(){S.value=!1,!e.disabled&&o.value!==1&&(o.value=1,x.value=null)},openCombobox(){if(S.value=!0,e.disabled||o.value===0)return;let m=f.value.findIndex(g=>{let R=V(g.dataRef.value);return K(p.value,{[0]:()=>y.compare(V(y.value.value),V(R)),[1]:()=>V(y.value.value).some(r=>y.compare(V(r),V(R)))})});m!==-1&&(x.value=m),o.value=0},goToOption(m,g,R){if(S.value=!1,e.disabled||i.value&&!c.value.static&&o.value===1)return;let r=P();if(r.activeOptionIndex===null){let w=r.options.findIndex(Q=>!Q.dataRef.disabled);w!==-1&&(r.activeOptionIndex=w)}let v=lt(m===E.Specific?{focus:E.Specific,id:g}:{focus:m},{resolveItems:()=>r.options,resolveActiveIndex:()=>r.activeOptionIndex,resolveId:w=>w.id,resolveDisabled:w=>w.dataRef.disabled});x.value=v,O.value=R??1,f.value=r.options},selectOption(m){let g=f.value.find(r=>r.id===m);if(!g)return;let{dataRef:R}=g;L(K(p.value,{[0]:()=>R.value,[1]:()=>{let r=V(y.value.value).slice(),v=V(R.value),w=r.findIndex(Q=>y.compare(v,V(Q)));return w===-1?r.push(v):r.splice(w,1),r}}))},selectActiveOption(){if(y.activeOptionIndex.value===null)return;let{dataRef:m,id:g}=f.value[y.activeOptionIndex.value];L(K(p.value,{[0]:()=>m.value,[1]:()=>{let R=V(y.value.value).slice(),r=V(m.value),v=R.findIndex(w=>y.compare(r,V(w)));return v===-1?R.push(r):R.splice(v,1),R}})),y.goToOption(E.Specific,g)},registerOption(m,g){let R={id:m,dataRef:g},r=P(v=>[...v,R]);if(x.value===null){let v=g.value.value;K(p.value,{[0]:()=>y.compare(V(y.value.value),V(v)),[1]:()=>V(y.value.value).some(w=>y.compare(V(w),V(v)))})&&(r.activeOptionIndex=r.options.indexOf(R))}f.value=r.options,x.value=r.activeOptionIndex,O.value=1},unregisterOption(m){var g;y.activeOptionIndex.value!==null&&((g=y.options.value[y.activeOptionIndex.value])==null?void 0:g.id)===m&&(S.value=!0);let R=P(r=>{let v=r.findIndex(w=>w.id===m);return v!==-1&&r.splice(v,1),r});f.value=R.options,x.value=R.activeOptionIndex,O.value=1}};ke([n,s,i],()=>y.closeCombobox(),h(()=>o.value===0)),Fe(_e,y),De(h(()=>K(o.value,{[0]:oe.Open,[1]:oe.Closed})));let H=h(()=>y.activeOptionIndex.value===null?null:f.value[y.activeOptionIndex.value].dataRef.value),q=h(()=>{var m;return(m=k(n))==null?void 0:m.closest("form")});return ne(()=>{ie([q],()=>{if(!q.value||e.defaultValue===void 0)return;function m(){y.change(e.defaultValue)}return q.value.addEventListener("reset",m),()=>{var g;(g=q.value)==null||g.removeEventListener("reset",m)}},{immediate:!0})}),()=>{let{name:m,disabled:g,...R}=e,r={open:o.value===0,disabled:g,activeIndex:y.activeOptionIndex.value,activeOption:H.value,value:_.value};return re(j,[...m!=null&&_.value!=null?ye({[m]:_.value}).map(([v,w])=>re(Ne,Te({features:Le.Hidden,key:v,as:"input",type:"hidden",hidden:!0,readOnly:!0,name:v,value:w}))):[],Y({theirProps:{...a,...me(R,["modelValue","defaultValue","nullable","multiple","onUpdate:modelValue","by"])},ourProps:{},slot:r,slots:l,attrs:a,name:"Combobox"})])}}}),Se=A({name:"ComboboxLabel",props:{as:{type:[Object,String],default:"label"},id:{type:String,default:()=>`headlessui-combobox-label-${te()}`}},setup(e,{attrs:l,slots:a}){let d=Z("ComboboxLabel");function o(){var t;(t=k(d.inputRef))==null||t.focus({preventScroll:!0})}return()=>{let t={open:d.comboboxState.value===0,disabled:d.disabled.value},{id:n,...s}=e,i={id:n,ref:d.labelRef,onClick:o};return Y({ourProps:i,theirProps:s,slot:t,attrs:l,slots:a,name:"ComboboxLabel"})}}}),Ie=A({name:"ComboboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:()=>`headlessui-combobox-button-${te()}`}},setup(e,{attrs:l,slots:a,expose:d}){let o=Z("ComboboxButton");d({el:o.buttonRef,$el:o.buttonRef});function t(i){o.disabled.value||(o.comboboxState.value===0?o.closeCombobox():(i.preventDefault(),o.openCombobox()),G(()=>{var c;return(c=k(o.inputRef))==null?void 0:c.focus({preventScroll:!0})}))}function n(i){switch(i.key){case U.ArrowDown:i.preventDefault(),i.stopPropagation(),o.comboboxState.value===1&&o.openCombobox(),G(()=>{var c;return(c=o.inputRef.value)==null?void 0:c.focus({preventScroll:!0})});return;case U.ArrowUp:i.preventDefault(),i.stopPropagation(),o.comboboxState.value===1&&(o.openCombobox(),G(()=>{o.value.value||o.goToOption(E.Last)})),G(()=>{var c;return(c=o.inputRef.value)==null?void 0:c.focus({preventScroll:!0})});return;case U.Escape:if(o.comboboxState.value!==0)return;i.preventDefault(),o.optionsRef.value&&!o.optionsPropsRef.value.static&&i.stopPropagation(),o.closeCombobox(),G(()=>{var c;return(c=o.inputRef.value)==null?void 0:c.focus({preventScroll:!0})});return}}let s=nt(h(()=>({as:e.as,type:l.type})),o.buttonRef);return()=>{var i,c;let f={open:o.comboboxState.value===0,disabled:o.disabled.value,value:o.value.value},{id:x,...O}=e,S={ref:o.buttonRef,id:x,type:s.value,tabindex:"-1","aria-haspopup":"listbox","aria-controls":(i=k(o.optionsRef))==null?void 0:i.id,"aria-expanded":o.disabled.value?void 0:o.comboboxState.value===0,"aria-labelledby":o.labelRef.value?[(c=k(o.labelRef))==null?void 0:c.id,x].join(" "):void 0,disabled:o.disabled.value===!0?!0:void 0,onKeydown:n,onClick:t};return Y({ourProps:S,theirProps:O,slot:f,attrs:l,slots:a,name:"ComboboxButton"})}}}),Ce=A({name:"ComboboxInput",props:{as:{type:[Object,String],default:"input"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},displayValue:{type:Function},defaultValue:{type:String,default:void 0},id:{type:String,default:()=>`headlessui-combobox-input-${te()}`}},emits:{change:e=>!0},setup(e,{emit:l,attrs:a,slots:d,expose:o}){let t=Z("ComboboxInput"),n={value:!1};o({el:t.inputRef,$el:t.inputRef});let s=h(()=>{var p;let b=t.value.value;return k(t.inputRef)?typeof e.displayValue<"u"&&b!==void 0?(p=e.displayValue(b))!=null?p:"":typeof b=="string"?b:"":""});ne(()=>{ie([s,t.comboboxState],([p,b],[_,L])=>{if(n.value)return;let y=k(t.inputRef);y&&(L===0&&b===1||p!==_)&&(y.value=p)},{immediate:!0}),ie([t.comboboxState],([p],[b])=>{if(p===0&&b===1){let _=k(t.inputRef);if(!_)return;let L=_.value,{selectionStart:y,selectionEnd:H,selectionDirection:q}=_;_.value="",_.value=L,q!==null?_.setSelectionRange(y,H,q):_.setSelectionRange(y,H)}})});let i=D(!1);function c(){i.value=!0}function f(){setTimeout(()=>{i.value=!1})}function x(p){switch(n.value=!0,p.key){case U.Backspace:case U.Delete:if(t.mode.value!==0||!t.nullable.value)return;let b=p.currentTarget;requestAnimationFrame(()=>{if(b.value===""){t.change(null);let _=k(t.optionsRef);_&&(_.scrollTop=0),t.goToOption(E.Nothing)}});break;case U.Enter:if(n.value=!1,t.comboboxState.value!==0||i.value)return;if(p.preventDefault(),p.stopPropagation(),t.activeOptionIndex.value===null){t.closeCombobox();return}t.selectActiveOption(),t.mode.value===0&&t.closeCombobox();break;case U.ArrowDown:return n.value=!1,p.preventDefault(),p.stopPropagation(),K(t.comboboxState.value,{[0]:()=>t.goToOption(E.Next),[1]:()=>t.openCombobox()});case U.ArrowUp:return n.value=!1,p.preventDefault(),p.stopPropagation(),K(t.comboboxState.value,{[0]:()=>t.goToOption(E.Previous),[1]:()=>{t.openCombobox(),G(()=>{t.value.value||t.goToOption(E.Last)})}});case U.Home:if(p.shiftKey)break;return n.value=!1,p.preventDefault(),p.stopPropagation(),t.goToOption(E.First);case U.PageUp:return n.value=!1,p.preventDefault(),p.stopPropagation(),t.goToOption(E.First);case U.End:if(p.shiftKey)break;return n.value=!1,p.preventDefault(),p.stopPropagation(),t.goToOption(E.Last);case U.PageDown:return n.value=!1,p.preventDefault(),p.stopPropagation(),t.goToOption(E.Last);case U.Escape:if(n.value=!1,t.comboboxState.value!==0)return;p.preventDefault(),t.optionsRef.value&&!t.optionsPropsRef.value.static&&p.stopPropagation(),t.closeCombobox();break;case U.Tab:if(n.value=!1,t.comboboxState.value!==0)return;t.mode.value===0&&t.selectActiveOption(),t.closeCombobox();break}}function O(p){t.openCombobox(),l("change",p)}function S(){n.value=!1}let P=h(()=>{var p,b,_,L;return(L=(_=(b=e.defaultValue)!=null?b:t.defaultValue.value!==void 0?(p=e.displayValue)==null?void 0:p.call(e,t.defaultValue.value):null)!=null?_:t.defaultValue.value)!=null?L:""});return()=>{var p,b,_,L,y,H;let q={open:t.comboboxState.value===0},{id:m,displayValue:g,onChange:R,...r}=e,v={"aria-controls":(p=t.optionsRef.value)==null?void 0:p.id,"aria-expanded":t.disabled.value?void 0:t.comboboxState.value===0,"aria-activedescendant":t.activeOptionIndex.value===null||(b=t.options.value[t.activeOptionIndex.value])==null?void 0:b.id,"aria-labelledby":(y=(_=k(t.labelRef))==null?void 0:_.id)!=null?y:(L=k(t.buttonRef))==null?void 0:L.id,"aria-autocomplete":"list",id:m,onCompositionstart:c,onCompositionend:f,onKeydown:x,onInput:O,onBlur:S,role:"combobox",type:(H=a.type)!=null?H:"text",tabIndex:0,ref:t.inputRef,defaultValue:P.value};return Y({ourProps:v,theirProps:r,slot:q,attrs:a,slots:d,features:ae.RenderStrategy|ae.Static,name:"ComboboxInput"})}}}),Oe=A({name:"ComboboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},hold:{type:[Boolean],default:!1}},setup(e,{attrs:l,slots:a,expose:d}){let o=Z("ComboboxOptions"),t=`headlessui-combobox-options-${te()}`;d({el:o.optionsRef,$el:o.optionsRef}),ee(()=>{o.optionsPropsRef.value.static=e.static}),ee(()=>{o.optionsPropsRef.value.hold=e.hold});let n=Ee(),s=h(()=>n!==null?(n.value&oe.Open)===oe.Open:o.comboboxState.value===0);return it({container:h(()=>k(o.optionsRef)),enabled:h(()=>o.comboboxState.value===0),accept(i){return i.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:i.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(i){i.setAttribute("role","none")}}),()=>{var i,c,f;let x={open:o.comboboxState.value===0},O={"aria-labelledby":(f=(i=k(o.labelRef))==null?void 0:i.id)!=null?f:(c=k(o.buttonRef))==null?void 0:c.id,id:t,ref:o.optionsRef,role:"listbox","aria-multiselectable":o.mode.value===1?!0:void 0},S=me(e,["hold"]);return Y({ourProps:O,theirProps:S,slot:x,attrs:l,slots:a,features:ae.RenderStrategy|ae.Static,visible:s.value,name:"ComboboxOptions"})}}}),Re=A({name:"ComboboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1}},setup(e,{slots:l,attrs:a,expose:d}){let o=Z("ComboboxOption"),t=`headlessui-combobox-option-${te()}`,n=D(null);d({el:n,$el:n});let s=h(()=>o.activeOptionIndex.value!==null?o.options.value[o.activeOptionIndex.value].id===t:!1),i=h(()=>K(o.mode.value,{[0]:()=>o.compare(V(o.value.value),V(e.value)),[1]:()=>V(o.value.value).some(b=>o.compare(V(b),V(e.value)))})),c=h(()=>({disabled:e.disabled,value:e.value,domRef:n}));ne(()=>o.registerOption(t,c)),Be(()=>o.unregisterOption(t)),ee(()=>{o.comboboxState.value===0&&s.value&&o.activationTrigger.value!==0&&G(()=>{var b,_;return(_=(b=k(n))==null?void 0:b.scrollIntoView)==null?void 0:_.call(b,{block:"nearest"})})});function f(b){if(e.disabled)return b.preventDefault();o.selectOption(t),o.mode.value===0&&o.closeCombobox(),Ae()||requestAnimationFrame(()=>{var _;return(_=k(o.inputRef))==null?void 0:_.focus()})}function x(){if(e.disabled)return o.goToOption(E.Nothing);o.goToOption(E.Specific,t)}let O=st();function S(b){O.update(b)}function P(b){O.wasMoved(b)&&(e.disabled||s.value||o.goToOption(E.Specific,t,0))}function p(b){O.wasMoved(b)&&(e.disabled||s.value&&(o.optionsPropsRef.value.hold||o.goToOption(E.Nothing)))}return()=>{let{disabled:b}=e,_={active:s.value,selected:i.value,disabled:b},L={id:t,ref:n,role:"option",tabIndex:b===!0?void 0:-1,"aria-disabled":b===!0?!0:void 0,"aria-selected":i.value,disabled:void 0,onClick:f,onFocus:x,onPointerenter:S,onMouseenter:S,onPointermove:P,onMousemove:P,onPointerleave:p,onMouseleave:p};return Y({ourProps:L,theirProps:e,slot:_,attrs:a,slots:l,name:"ComboboxOption"})}}});const vt={class:"relative mt-2"},mt=A({__name:"DropdownCustomer",props:{modelValue:null},emits:["update:modelValue"],setup(e,{emit:l}){const a=e,d=h({get:()=>{var s;return(s=o.value)==null?void 0:s.find(i=>i.id===a.modelValue)},set:s=>s&&l("update:modelValue",s.id)}),{data:o}=qe(),t=D(""),n=h(()=>{var s;return t.value?((s=o.value)==null?void 0:s.filter(i=>i.name.toLowerCase().includes(t.value.toLowerCase())))||[]:o.value||[]});return(s,i)=>(I(),F(u(we),{as:"div",modelValue:u(d),"onUpdate:modelValue":i[1]||(i[1]=c=>z(d)?d.value=c:null)},{default:B(()=>{var c;return[N(u(Se),{class:"block text-sm font-medium leading-6 text-gray-900"},{default:B(()=>[M(" Customer ")]),_:1}),C("div",vt,[N(u(Ce),{class:"w-full rounded-md border-0 bg-white py-1.5 pl-3 pr-10 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6",onChange:i[0]||(i[0]=f=>t.value=f.target.value),"display-value":f=>f.name},null,8,["display-value"]),N(u(Ie),{class:"absolute inset-y-0 right-0 flex items-center px-2 rounded-r-md focus:outline-none"},{default:B(()=>[N(u(fe),{class:"w-5 h-5 text-gray-400","aria-hidden":"true"})]),_:1}),((c=u(n))==null?void 0:c.length)>0?(I(),F(u(Oe),{key:0,class:"absolute z-10 w-full py-1 mt-1 overflow-auto text-base bg-white rounded-md shadow-lg max-h-60 ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:B(()=>[(I(!0),T(j,null,ue(u(n),f=>(I(),F(u(Re),{key:f.id,value:f,as:"template"},{default:B(({active:x,selected:O})=>[C("li",{class:J(["relative cursor-default select-none py-2 pl-3 pr-9",x?"bg-indigo-600 text-white":"text-gray-900"])},[C("span",{class:J(["block truncate",O&&"font-semibold"])},$(f.name),3),O?(I(),T("span",{key:0,class:J(["absolute inset-y-0 right-0 flex items-center pr-4",x?"text-white":"text-indigo-600"])},[N(u(be),{class:"w-5 h-5","aria-hidden":"true"})],2)):W("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})):W("",!0)])]}),_:1},8,["modelValue"]))}}),ft=A({__name:"DropdownUnitQuantity",props:{modelValue:null,isLabelHidden:{type:Boolean},isNoMargin:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:l}){const a=e,d=Me.options,o=h({get:()=>a.modelValue,set:s=>l("update:modelValue",s)}),t=D(""),n=h(()=>t.value?(d==null?void 0:d.filter(s=>s.toLowerCase().includes(t.value.toLowerCase())))||[]:d||[]);return(s,i)=>(I(),F(u(we),{as:"div",modelValue:u(o),"onUpdate:modelValue":i[1]||(i[1]=c=>z(o)?o.value=c:null)},{default:B(()=>{var c;return[e.isLabelHidden?W("",!0):(I(),F(u(Se),{key:0,class:"block text-sm font-medium leading-6 text-gray-900"},{default:B(()=>[M(" Unit ")]),_:1})),C("div",{class:J(["relative",{"mt-2":!e.isNoMargin}])},[N(u(Ce),{class:"w-full rounded-md border-0 bg-white py-1.5 pl-3 pr-10 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6",onChange:i[0]||(i[0]=f=>t.value=f.target.value)}),N(u(Ie),{class:"absolute inset-y-0 right-0 flex items-center px-2 rounded-r-md focus:outline-none"},{default:B(()=>[N(u(fe),{class:"w-5 h-5 text-gray-400","aria-hidden":"true"})]),_:1}),((c=u(n))==null?void 0:c.length)>0?(I(),F(u(Oe),{key:0,class:"absolute z-10 w-full py-1 mt-1 overflow-auto text-base bg-white rounded-md shadow-lg max-h-60 ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:B(()=>[(I(!0),T(j,null,ue(u(n),f=>(I(),F(u(Re),{key:f,value:f,as:"template"},{default:B(({active:x,selected:O})=>[C("li",{class:J(["relative cursor-default select-none py-2 pl-3 pr-9",x?"bg-indigo-600 text-white":"text-gray-900"])},[C("span",{class:J(["block truncate",O&&"font-semibold"])},$(f),3),O?(I(),T("span",{key:0,class:J(["absolute inset-y-0 right-0 flex items-center pr-4",x?"text-white":"text-indigo-600"])},[N(u(be),{class:"w-5 h-5","aria-hidden":"true"})],2)):W("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})):W("",!0)],2)]}),_:1},8,["modelValue"]))}}),bt={class:"py-4 pl-4 pr-3 text-sm font-medium text-gray-900 whitespace-nowrap sm:pl-0"},xt={class:"px-3 py-4 text-sm text-gray-500 whitespace-nowrap"},yt={class:"px-3 py-4 text-sm text-gray-500 whitespace-nowrap"},gt={class:"px-3 py-4 text-sm text-gray-500 whitespace-nowrap"},ht={class:"px-3 py-4 text-sm text-gray-500 whitespace-nowrap"},_t={class:"px-3 py-4 text-sm text-gray-500 whitespace-nowrap text-right"},wt={class:"relative py-4 pl-3 pr-4 text-sm font-medium text-right whitespace-nowrap sm:pr-0"},St=A({__name:"InvoicePositionItem",props:{invoicePosition:null},emits:["update:invoicePosition"],setup(e,{emit:l}){const a=e,d=O=>({...O,price:O.quantity*O.price_per_quantity}),o=O=>h({get:()=>a.invoicePosition[O],set:S=>{l("update:invoicePosition",d({...a.invoicePosition,[O]:S}))}}),t=o("service_date"),n=o("description"),s=o("quantity"),i=o("unit_quantity"),c=o("price_per_quantity"),f=h(()=>a.invoicePosition.price),x=D(!1);return(O,S)=>(I(),T("tr",null,[C("td",bt,[x.value?(I(),F(X,{key:0,"is-label-hidden":"","is-no-margin":"",name:"Service Date",type:"date",modelValue:u(t),"onUpdate:modelValue":S[0]||(S[0]=P=>z(t)?t.value=P:null),class:"-m-4 -mr-3"},null,8,["modelValue"])):(I(),T(j,{key:1},[M($(u(je)(new Date(u(t)))),1)],64))]),C("td",xt,[x.value?(I(),F(X,{key:0,"is-label-hidden":"","is-no-margin":"",name:"Description",type:"text",modelValue:u(n),"onUpdate:modelValue":S[1]||(S[1]=P=>z(n)?n.value=P:null),class:"-mx-2 -my-4"},null,8,["modelValue"])):(I(),T(j,{key:1},[M($(u(n)),1)],64))]),C("td",yt,[x.value?(I(),F(X,{key:0,"is-label-hidden":"","is-no-margin":"",name:"Quantity",type:"number",step:"0.01",modelValue:u(s),"onUpdate:modelValue":S[2]||(S[2]=P=>z(s)?s.value=P:null),class:"-mx-2 -my-4"},null,8,["modelValue"])):(I(),T(j,{key:1},[M($(u(He)(u(s),u(i))),1)],64))]),C("td",gt,[x.value?(I(),F(ft,{key:0,"is-label-hidden":"","is-no-margin":"",modelValue:u(i),"onUpdate:modelValue":S[3]||(S[3]=P=>z(i)?i.value=P:null),class:"-mx-2 -my-4"},null,8,["modelValue"])):(I(),T(j,{key:1},[M($(u(Qe)(u(s),u(i))),1)],64))]),C("td",ht,[x.value?(I(),F(X,{key:0,"is-label-hidden":"","is-no-margin":"",name:"Price Per Quantity",type:"number",modelValue:u(c),"onUpdate:modelValue":S[4]||(S[4]=P=>z(c)?c.value=P:null),class:"-mx-2 -my-4"},null,8,["modelValue"])):(I(),T(j,{key:1},[M($(u(de)(u(c)))+" / "+$(u(i)),1)],64))]),C("td",_t,$(u(de)(u(f))),1),C("td",wt,[C("button",{onClick:S[5]||(S[5]=se(P=>x.value=!x.value,["prevent"])),class:"text-indigo-600 hover:text-indigo-900"},$(x.value?"Done":"Edit"),1)])]))}}),It={class:"flow-root mt-8"},Ct={class:"-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8"},Ot={class:"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8"},Rt={class:"min-w-full divide-y divide-gray-300"},Vt=C("thead",null,[C("tr",null,[C("th",{scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-0"}," Service Date "),C("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Description "),C("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Quantity "),C("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Unit Quantity "),C("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Price per Quantity "),C("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Price "),C("th",{scope:"col",class:"relative py-3.5 pl-3 pr-4 sm:pr-0"},[C("span",{class:"sr-only"},"Edit")])])],-1),Pt={class:"divide-y divide-gray-200"},kt=A({__name:"InvoicePositionTable",emits:["createPosition"],setup(e){return(l,a)=>(I(),T("div",It,[C("div",Ct,[C("div",Ot,[C("table",Rt,[Vt,C("tbody",Pt,[Ke(l.$slots,"default")])]),N(le,{class:"ml-auto",onClick:a[0]||(a[0]=se(d=>l.$emit("createPosition"),["prevent"]))},{default:B(()=>[M(" New Invoice Position ")]),_:1})])])]))}}),Dt={key:0},Nt={key:1},Tt=A({__name:"InvoiceCalendarList",props:{customerId:null,month:null,year:null},setup(e){const l=e,{customerId:a}=xe(l),{data:d,error:o}=ze(a),t=h(()=>d.value?d.value.filter(s=>s.month===l.month).filter(s=>s.year===l.year):[]);return(n,s)=>(I(),T("div",null,[u(t).length?(I(),T("div",Dt,[C("div",null,"Found "+$(u(t).length)+" items in the calendar",1),N(le,{onClick:s[0]||(s[0]=i=>n.$emit("importCalendarEvents",u(t)))},{default:B(()=>[M("Import")]),_:1})])):W("",!0),u(o)?(I(),T("div",Nt,"Error: "+$(u(o)),1)):W("",!0)]))}}),Lt={key:0},Et={key:1},Bt=["onSubmit"],Ut={class:"grid grid-cols-2 space-x-2"},jt=A({__name:"InvoiceDetailView",props:{invoiceId:null},setup(e){const l=e,{invoiceId:a}=xe(l),d=Xe(),{query:o}=d,t=We({id:a,customer_id:Number(o.customer_id)||0,for_month:Number(o.for_month)||0,for_year:Number(o.for_year)||0,invoice_number:0,invoice_position:[]}),n=h({get:()=>Ye({year:t.for_year,month:t.for_month}),set:r=>{const[v,w]=r.split("-");v.length<4||(t.for_year=Number(v),t.for_month=Number(w))}}),{data:s}=Ge(h(()=>t.customer_id)),i=()=>{var r;t.invoice_position=[...t.invoice_position,{service_date:new Date().toISOString().slice(0,10),description:"",quantity:0,unit_quantity:"Stunde",price_per_quantity:((r=s.value)==null?void 0:r.default_price_per_hour)||0,price:0}]},c=({index:r,invoicePosition:v})=>{t.invoice_position=[...t.invoice_position.slice(0,r),v,...t.invoice_position.slice(r+1)]},{data:f,isError:x,isLoading:O,error:S}=et(a);pe(f,()=>{Object.assign(t,Je.omit(f.value,"id"))});const{nextInvoiceNumber:P,isLoading:p}=tt(),b=h(()=>{var r;return a!=null&&a.value?(r=f.value)==null?void 0:r.invoice_number:P.value});pe(b,r=>{t.invoice_number=r});const _=h(()=>O.value||p.value),L=r=>{t.invoice_position=[...t.invoice_position,...r.map(v=>{var w,Q;return{service_date:new Date(v.year,v.month-1,v.day).toISOString().slice(0,10),description:v.title,quantity:v.durationInHours,unit_quantity:"Stunde",price_per_quantity:((w=s.value)==null?void 0:w.default_price_per_hour)||0,price:v.durationInHours*(((Q=s.value)==null?void 0:Q.default_price_per_hour)||0)}})]},{mutateAsync:y,isLoading:H}=ot(),q=async()=>{const r=await y(t);a!=null&&a.value||m.replace(`/invoice/${r.invoiceId}`)},m=Ze(),g=h(()=>!!(a!=null&&a.value)),R=()=>{g.value&&m.push(`/invoice/${a==null?void 0:a.value}/print`)};return(r,v)=>(I(),T(j,null,[u(_)?(I(),T("div",Lt,"Loading...")):u(x)?(I(),T("div",Et,"Error: "+$(u(S)),1)):W("",!0),C("form",{onSubmit:se(q,["prevent"]),class:"space-y-6"},[N(mt,{modelValue:u(t).customer_id,"onUpdate:modelValue":v[0]||(v[0]=w=>u(t).customer_id=w)},null,8,["modelValue"]),N(X,{name:"Invoice Number",type:"number",min:"0",modelValue:u(t).invoice_number,"onUpdate:modelValue":v[1]||(v[1]=w=>u(t).invoice_number=w)},null,8,["modelValue"]),N(X,{name:"For Month",type:"date",modelValue:u(n),"onUpdate:modelValue":v[2]||(v[2]=w=>z(n)?n.value=w:null)},null,8,["modelValue"]),N(kt,{onCreatePosition:i},{default:B(()=>[(I(!0),T(j,null,ue(u(t).invoice_position,(w,Q)=>(I(),F(St,{key:Q,"invoice-position":w,"onUpdate:invoicePosition":Ve=>c({index:Q,invoicePosition:Ve})},null,8,["invoice-position","onUpdate:invoicePosition"]))),128))]),_:1}),C("div",Ut,[N(le,{type:"submit"},{default:B(()=>[M("Save "+$(u(H)?"...":""),1)]),_:1}),N(le,{disabled:!u(g),onClick:R},{default:B(()=>[M("Print")]),_:1},8,["disabled"])])],40,Bt),N(Tt,{class:"mt-6",customerId:u(t).customer_id,month:u(t).for_month,year:u(t).for_year,onImportCalendarEvents:v[3]||(v[3]=w=>L(w))},null,8,["customerId","month","year"])],64))}});export{jt as default};
